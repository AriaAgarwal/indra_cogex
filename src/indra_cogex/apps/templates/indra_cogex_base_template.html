{% from "auth_macros.html" import login_overlay %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>INDRA CoGEx</title>

    <!-- Bootstrap 4.6.1 CSS -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/css/bootstrap.min.css"
          integrity="sha384-zCbKRCUGaJDkqS1kPbPd7TveP5iyJE0EjAuZQTgFLD2ylzuqKfdKlfG/eSrtxUkn" crossorigin="anonymous">
    <!-- jQuery 3.5.1 -->
    <script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.slim.min.js"
            integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj"
            crossorigin="anonymous"></script>
    <!-- Bootstrap 4.6.1 JS -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.1/dist/js/bootstrap.bundle.min.js"
            integrity="sha384-fQybjgWLrvvRgtW6bFlB7jaZrFsaBXjsOMm/tB9LTS58ONXgqbR9W8oWht/amnpF"
            crossorigin="anonymous"></script>

    {# todo: load css from external stylesheet #}
    <style>
        #loginout-button {
            margin-top: 5px;
            margin-bottom: 5px;
        }

        .no-horiz-pad {
            padding-left: 0;
            padding-right: 0;
        }

        #page-header {
            position: relative;
            margin-bottom: 40px;
        }

    </style>

    {% block extend_head_tag %}
    {% endblock %}
</head>
<body>
{% block navbar %}
    {% block load_login %}
    {{ login_overlay(url_prefix="") }}
    <script>
        function handle_success(type, resp_data) {
            if (type === "login") {
                const btn = document.querySelector("#loginout-button");
                btn.innerHTML = 'Logout';
                btn.onclick = () => {
                    return trigger_logout()
                };
                report_login_result(''); // clear the login result message
            } else if (type === "register") {
                trigger_login()
            } else { // logout
                const btn = document.querySelector("#loginout-button");
                btn.innerHTML = 'Login';
                btn.onclick = () => {
                    return trigger_login()
                };
            }
        }

        function trigger_login(type = null, data = null) {
            return login(handle_success, trigger_unchecked_login)
        }

        function trigger_unchecked_login(type = null, data = null) {
            return login(handle_success, trigger_unchecked_login, true)
        }

        function trigger_logout() {
            return logout(handle_success)
        }
    </script>

    <header id="page-header" class="bg-white border-bottom shadow-sm fixed-top no-horiz-pad">
        <div class="d-flex flex-row align-items-center justify-content-end">
            {% block extend_header %}
            {% endblock %}
            <nav class="d-inline-flex p-2">
                {#        <a class="p-2 text-dark" href="" target="_blank">Nav1</a>#}
                <a class="p-2 text-dark" href="#about">About</a>
                {#        <a class="p-2 text-dark" href="">Nav2</a>#}
            </nav>
            <div class="d-inline-flex button-container p-2">
                <button class="btn btn-primary"
                        onclick="return {% if user_email %}trigger_logout(){% else %}trigger_login(){% endif %};"
                        id="loginout-button">
                    {% if user_email %}
                        Logout
                    {% else %}
                        Login
                    {% endif %}
                </button>
            </div>
        </div>
    </header>
    {% endblock load_login %}
{% endblock %}

{% block content %}
{% endblock %}

{% block footer %}
    <footer class="footer text-muted" id="about" style="background: #F5F5F5;">
        <div class="container">
            <h5 class="my-0 mr-md-auto font-weight-normal">About</h5>
            <small>
                <p class="float-right">
                    <a href="#">Back to top</a>
                </p>
                <p><a href="https://indralab.github.io" target="_blank">INDRALAB</a></p>
                <p><a href="http://hits.harvard.edu" target="_blank">Harvard Program in Therapeutic Science
                    (HiTS)</a></p>
                <p><b>DARPA Young Faculty Award (YFA)</b><br>INDRA CoGEx (Context Graph Extension) is an automatically
                    assembled biomedical knowledge graph which integrates causal mechanisms from INDRA with
                    non-causal contextual relations including properties, ontology, and data.<br><i>The development
                        of this project is funded under the DARPA Young Faculty Award (ARO grant W911NF2010255).</i>
                </p>
            </small>
        </div>
    </footer>
{% endblock %}

{% block end_body %}
{% endblock %}
</body>
</html>